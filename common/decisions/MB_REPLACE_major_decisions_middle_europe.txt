#MODIFIED VANILLA EVENTS


#Uniting the Burgundies
unify_burgundy_kingdom_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"

	desc = unify_burgundy_kingdom_decision_desc
	selection_tooltip = unify_burgundy_kingdom_decision_tooltip
	major = yes
	ai_goal = yes

	is_shown = {
		culture = { has_cultural_pillar = heritage_frankish }
		is_ruler = yes
		is_landed = yes
		NOT = {
			exists = title:k_burgundy.holder
		}
		NOT = {  #Can only do it once.
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_unified_burgundy_kingdom
			}
		}
		highest_held_title_tier < 4 #No Kings or Emperors.
		top_liege = {
			OR = {
				has_title = title:k_france
				has_title = title:e_france
				has_title = title:e_hre
			}
		}
		capital_province = { geographical_region = k_burgundy }
	}
	
	is_valid = {
		prestige_level >= high_prestige_level
		completely_controls_region = k_burgundy
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = no
		is_at_war = no
	}

	cost = {
		gold = 1000
	}

	effect = {
		if = {
			limit = {
				NOT = { has_culture = culture:occitan }
			}
			set_culture = culture:occitan
			add_character_flag = converted_culture_this_lifetime
		}
		custom_tooltip = unify_burgundy_kingdom_decision_effect_tooltip
		show_as_tooltip = {
			unite_burgundies_scripted_effect = yes
		}
		trigger_event = {
			id = middle_europe_decisions.0007
		}
		hidden_effect = {
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:flag_unified_burgundy_kingdom
			}
			set_global_variable = {
				name = flag_unified_burgundy_kingdom
				value = root
			}
		}
	}
	
	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 5
		ai_value_modifier = {
			ai_boldness = 1.0
		}
	}
}

historical_catholic_westslav_conversion_decision = {
	
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"
	
	major = yes
	
	#ai_goal = yes
	
	ai_check_interval = 12
	
	desc = historical_catholic_westslav_conversion_decision_desc
	selection_tooltip = historical_catholic_westslav_conversion_decision_tooltip
	
	is_shown = {
		NAND = {
			root = { is_ai = yes }
			current_date < 966
		}
		is_ruler = yes
		culture = { has_cultural_pillar = heritage_west_slavic }
		NOT = { religion = religion:christianity_religion }
		#Slavic Paganism must not have been reformed.
		religion:slavic_religion = {
			any_faith = {
				count = all
				has_doctrine = unreformed_faith_doctrine
			}
		}
		OR = {
			has_primary_title = title:k_poland
			primary_title = {
				OR = {
					de_jure_liege = title:e_west_slavia
					de_jure_liege.de_jure_liege = title:e_west_slavia
					de_jure_liege.de_jure_liege.de_jure_liege = title:e_west_slavia
					de_jure_liege.de_jure_liege.de_jure_liege.de_jure_liege = title:e_west_slavia
				}
			}
		}
	}
	
	is_valid = {
		is_independent_ruler = yes
	}
	
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		is_capable_adult = yes
	}
	
	effect = {
        set_character_faith_with_conversion = faith:catholic
		hidden_effect = {
			primary_title = {
				every_in_de_facto_hierarchy = {
					if = {
						limit = { development_level < 4 }
						change_development_level = 3
					}
				}
			}
		}
    }
	
	cost = {
		piety = 500
		gold = 100
	}
	
	ai_potential = {
		current_date >= 966.4.14
		#always = yes
	}

	ai_will_do = {
		base = 66
		modifier = {
			factor = 0
			current_date < 966
		}
	}
}

#Polish claim to Galicia
polish_expansion_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"

	desc = polish_expansion_decision_desc
	selection_tooltip = polish_expansion_decision_tooltip
	major = yes
	
	ai_check_interval = 1
	is_shown = {
		current_date >= 1350.1.1
		is_landed = yes
		has_primary_title = title:k_poland
		NOT = {	#You can only do it once.
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:polish_expansion_decision
			}
		}
	}
	
	is_valid = {
		is_independent_ruler = yes
	}	
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		hidden_effect = {
			add_pressed_claim = title:d_cherven_cities
			add_pressed_claim = title:d_halych
		}
		add_prestige = 1000
		add_gold = 1000
		add_piety = 500
		title:d_cherven_cities = { set_de_jure_liege_title = title:k_poland }
		title:d_halych = { set_de_jure_liege_title = title:k_poland }
		hidden_effect = {
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:polish_expansion_decision
			}
			spawn_army = {
				name = event_troop_default_name
				levies = 3000
				location = capital_province
				inheritable = yes
			}
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
		modifier = {
			factor = 0
			age > 35
		}
	}
}

settle_southern_bavaria = {
	
	picture = "gfx/interface/illustrations/decisions/decision_realm.dds"
	
	major = no
	
	#ai_goal = yes
	
	ai_check_interval = 10
	
    desc = settle_southern_bavaria_desc
	selection_tooltip = settle_southern_bavaria_tooltip
	
	is_shown = {
		game_start_date < 900.1.1
		culture = { has_cultural_pillar = heritage_central_germanic }
		current_date >= 950.1.1
		trigger_if = {
			limit = { NOT = { title:k_austria = { any_in_de_jure_hierarchy = { tier = tier_duchy } } } }
			title:k_bavaria = { any_in_de_jure_hierarchy = { tier = tier_county } }
		}
		trigger_if = {
			limit = { title:k_austria = { any_in_de_jure_hierarchy = { tier = tier_duchy } } }
			title:k_austria = { any_in_de_jure_hierarchy = { tier = tier_county } }
		}
		NOT = {	#You can only do it once.
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:bavarian_germanization_decision
			}
		}
	}
	
	is_valid = {
		is_available_adult = yes
		OR = {
			completely_controls = title:d_carinthia
			completely_controls = title:d_steyermark
		}
	}
	
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_capable_adult = yes
	}
	
	effect = {
		every_county_in_region = {
			region = germanized_bavaria_areas
			limit = {
				NOT = { culture = { has_cultural_pillar = heritage_central_germanic } }
			}
			set_county_culture = culture:bavarian
		}
		hidden_effect = {
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:bavarian_germanization_decision
			}
		}
    }
	
	cost = {
		prestige = 200
	}

	ai_will_do = {
		base = 33
	}
}